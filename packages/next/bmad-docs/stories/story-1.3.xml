<context>
  <story_id>1.3</story_id>
  <story_title>Implement "Add Link" action with advanced data</story_title>

  <user_story>
    As Olivia the Organizer, I want to have my link saved with the correct list and tags when I use the advanced mode, so that my link is fully organized in a single step.
  </user_story>

  <acceptance_criteria>
    - `addLink` action in `actions/chunk.ts` is modified to accept `listId` and `tags`.
    - When called with `listId` and `tags`, the new link is created with these associations.
    - `onAddOkBtnClick` in `BottomBarAddPopup.tsx` and `TopBarAddPopup.tsx` passes `listId` and `tags` from the Redux store to the `addLink` action.
  </acceptance_criteria>

  <dev_notes>
    This story builds on the state management work from Story 1.2. The focus is on making the `addLink` action aware of the new data.
  </dev_notes>

  <relevant_files>
    <file path="src/actions/chunk.ts">
      <summary>This file contains the `addLink` action creator. It needs to be modified to handle the new `listId` and `tags` parameters.</summary>
      <key_logic>
        - Modify the `addLink` function signature to `addLink(url, listName, doExtractContents, listId, tags)`.
        - Inside the action, if `listId` is provided, use it instead of the default `listName`.
        - If `tags` are provided, add them to the new link object.
        - The logic for creating the link and dispatching the `ADD_LINKS` action will need to be updated to include this new data.
      </key_logic>
    </file>
    <file path="src/components/BottomBarAddPopup.tsx">
      <summary>The "Save" button's click handler (`onAddOkBtnClick`) in this component needs to be updated to pass the advanced data to the `addLink` action.</summary>
      <key_logic>
        - Map `state.linkEditor.listId` and `state.linkEditor.tags` to the component's props.
        - In `onAddOkBtnClick`, call `this.props.addLink(url, null, null, this.props.listId, this.props.tags)`.
      </key_logic>
    </file>
    <file path="src/components/TopBarAddPopup.tsx">
      <summary>Similar to the bottom bar popup, the `onAddOkBtnClick` handler here must be updated to pass the new `listId` and `tags` from Redux.</summary>
      <key_logic>
        - Map `state.linkEditor.listId` and `state.linkEditor.tags` to the component's props.
        - In `onAddOkBtnClick`, call `this.props.addLink(url, null, null, this.props.listId, this.props.tags)`.
      </key_logic>
    </file>
  </relevant_files>

</context>